{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios, { Axios } from 'axios';\n\nconst API_KEY = '43770343-d10c460472ef62dd19f425fcf';\n\nexport async function getRequest(q, per_page, page) {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page,\n    page,\n  });\n\n  axios.defaults.baseURL = `https://pixabay.com/api/`;\n\n  return await axios(`?${searchParams}`);\n}\n","'use strict';\n\nexport function createGallery(hits) {\n  const gallery = hits\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"item-results\">\n          <a href=\"${largeImageURL}\" class=\"gallery-link\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\"/>\n          </a>\n          <div class=\"wrap-info\">\n            <ul class=\"list-info\">\n              <li class=\"item-info\">\n                <p class=\"headline-info\">Likes</p>\n                <p class=\"text-info\">${likes}</p>\n              </li>\n              <li class=\"item-info\">\n                <p class=\"headline-info\">Views</p>\n                <p class=\"text-info\">${views}</p>\n              </li>\n              <li class=\"item-info\">\n                <p class=\"headline-info\">Comments</p>\n                <p class=\"text-info\">${comments}</p>\n              </li>\n              <li class=\"item-info\">\n                <p class=\"headline-info\">Downloads</p>\n                <p class=\"text-info\">${downloads}</p>\n              </li>\n            </ul>\n          </div>\n        </li>`\n    )\n    .join('');\n\n  document\n    .querySelector('.list-results')\n    .insertAdjacentHTML('beforeend', gallery);\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getRequest } from './js/pixabay-api.js';\nimport { createGallery } from './js/render-functions.js';\n\nconst lightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst searchForm = document.querySelector('.form-search-img');\nconst inputForm = document.querySelector('.search-input');\nconst listResults = document.querySelector('.list-results');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst loader = document.querySelector('.loader');\n\nlet request = '';\nlet pageNumber = 1;\nlet itemsPerPage = 15;\n\nfunction getResponseFunc(request, itemsPerPage, pageNumber) {\n  return getRequest(request, itemsPerPage, pageNumber)\n    .then(({ data }) => {\n      if (data.hits.length === 0) {\n        return iziToast.info({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n      }\n\n      createGallery(data.hits);\n      lightbox.refresh();\n      loadMoreBtn.classList.remove('is-hidden');\n\n      const totalPages = Math.ceil(data.totalHits / itemsPerPage);\n\n      if (pageNumber >= totalPages) {\n        iziToast.warning({\n          message: 'We`re sorry, but you`ve reached the end of search results.',\n          position: 'topRight',\n        });\n        loadMoreBtn.classList.add('is-hidden');\n      }\n    })\n    .catch(error => console.log(error))\n    .finally(() => {\n      loader.classList.add('is-hidden');\n    });\n}\n\nfunction searchFormHandler(event) {\n  event.preventDefault();\n\n  request = inputForm.value.trim();\n  event.target.reset();\n\n  if (!request) {\n    return iziToast.warning({\n      message: 'The field cannot be empty!',\n      position: 'topRight',\n    });\n  }\n\n  loader.classList.remove('is-hidden');\n  listResults.innerHTML = '';\n  pageNumber = 1;\n\n  getResponseFunc(request, itemsPerPage, pageNumber);\n}\n\nasync function pageNumberIncrement() {\n  pageNumber += 1;\n\n  loadMoreBtn.classList.add('is-hidden');\n  loader.classList.remove('is-hidden');\n\n  await getResponseFunc(request, itemsPerPage, pageNumber);\n  smoothScrollOnLoadMore();\n}\n\nfunction smoothScrollOnLoadMore() {\n  const lastItemGallery = listResults.querySelector('.item-results:last-child');\n  const lastItemGalleryHeight = lastItemGallery.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: lastItemGalleryHeight * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nsearchForm.addEventListener('submit', searchFormHandler);\nloadMoreBtn.addEventListener('click', pageNumberIncrement);\n"],"names":["API_KEY","getRequest","q","per_page","page","searchParams","axios","createGallery","hits","gallery","largeImageURL","webformatURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","searchForm","inputForm","listResults","loadMoreBtn","loader","request","pageNumber","itemsPerPage","getResponseFunc","data","iziToast","totalPages","error","searchFormHandler","event","pageNumberIncrement","smoothScrollOnLoadMore","lastItemGalleryHeight"],"mappings":"owBAIA,MAAMA,EAAU,qCAET,eAAeC,EAAWC,EAAGC,EAAUC,EAAM,CAClD,MAAMC,EAAe,IAAI,gBAAgB,CACvC,IAAKL,EACL,EAAAE,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAAC,EACA,KAAAC,CACJ,CAAG,EAED,OAAAE,EAAM,SAAS,QAAU,2BAElB,MAAMA,EAAM,IAAID,CAAY,EAAE,CACvC,CClBO,SAASE,EAAcC,EAAM,CAClC,MAAMC,EAAUD,EACb,IACC,CAAC,CACC,cAAAE,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA,qBACaN,CAAa;AAAA,wBACVC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCAMXC,CAAK;AAAA;AAAA;AAAA;AAAA,uCAILC,CAAK;AAAA;AAAA;AAAA;AAAA,uCAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,uCAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,cAK3C,EACA,KAAK,EAAE,EAEV,SACG,cAAc,eAAe,EAC7B,mBAAmB,YAAaP,CAAO,CAC5C,CCnCA,MAAMQ,EAAW,IAAIC,EAAe,gBAAiB,CACnD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAa,SAAS,cAAc,kBAAkB,EACtDC,EAAY,SAAS,cAAc,eAAe,EAClDC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIC,EAAU,GACVC,EAAa,EACbC,EAAe,GAEnB,SAASC,EAAgBH,EAASE,EAAcD,EAAY,CAC1D,OAAOxB,EAAWuB,EAASE,EAAcD,CAAU,EAChD,KAAK,CAAC,CAAE,KAAAG,KAAW,CAClB,GAAIA,EAAK,KAAK,SAAW,EACvB,OAAOC,EAAS,KAAK,CACnB,QACE,2EACF,SAAU,UACpB,CAAS,EAGHtB,EAAcqB,EAAK,IAAI,EACvBX,EAAS,QAAO,EAChBK,EAAY,UAAU,OAAO,WAAW,EAExC,MAAMQ,EAAa,KAAK,KAAKF,EAAK,UAAYF,CAAY,EAEtDD,GAAcK,IAChBD,EAAS,QAAQ,CACf,QAAS,6DACT,SAAU,UACpB,CAAS,EACDP,EAAY,UAAU,IAAI,WAAW,EAE7C,CAAK,EACA,MAAMS,GAAS,QAAQ,IAAIA,CAAK,CAAC,EACjC,QAAQ,IAAM,CACbR,EAAO,UAAU,IAAI,WAAW,CACtC,CAAK,CACL,CAEA,SAASS,EAAkBC,EAAO,CAMhC,GALAA,EAAM,eAAc,EAEpBT,EAAUJ,EAAU,MAAM,OAC1Ba,EAAM,OAAO,QAET,CAACT,EACH,OAAOK,EAAS,QAAQ,CACtB,QAAS,6BACT,SAAU,UAChB,CAAK,EAGHN,EAAO,UAAU,OAAO,WAAW,EACnCF,EAAY,UAAY,GACxBI,EAAa,EAEbE,EAAgBH,EAASE,EAAcD,CAAU,CACnD,CAEA,eAAeS,GAAsB,CACnCT,GAAc,EAEdH,EAAY,UAAU,IAAI,WAAW,EACrCC,EAAO,UAAU,OAAO,WAAW,EAEnC,MAAMI,EAAgBH,EAASE,EAAcD,CAAU,EACvDU,GACF,CAEA,SAASA,GAAyB,CAEhC,MAAMC,EADkBf,EAAY,cAAc,0BAA0B,EAC9B,sBAAqB,EAAG,OAEtE,OAAO,SAAS,CACd,IAAKe,EAAwB,EAC7B,KAAM,EACN,SAAU,QACd,CAAG,CACH,CAEAjB,EAAW,iBAAiB,SAAUa,CAAiB,EACvDV,EAAY,iBAAiB,QAASY,CAAmB"}